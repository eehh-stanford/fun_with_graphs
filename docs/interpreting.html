<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Interpreting Scientific Figures – Fun with Graphs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./drawing.html" rel="next">
<link href="./gettingR.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-626149efe8f5d16e1d391ba177679bf0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./interpreting.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Interpreting Scientific Figures</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fun with Graphs</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Fun with Graphs</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gettingR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interpreting.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Interpreting Scientific Figures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./drawing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Theoretical Scientific Figures in <code>R</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Actual Graphs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./odes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">ODEs in <code>R</code></span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">2.1</span> Introduction</a></li>
  <li><a href="#lines" id="toc-lines" class="nav-link" data-scroll-target="#lines"><span class="header-section-number">2.2</span> Lines</a></li>
  <li><a href="#curves" id="toc-curves" class="nav-link" data-scroll-target="#curves"><span class="header-section-number">2.3</span> Curves</a>
  <ul class="collapse">
  <li><a href="#polynomial-curves" id="toc-polynomial-curves" class="nav-link" data-scroll-target="#polynomial-curves"><span class="header-section-number">2.3.1</span> Polynomial Curves</a></li>
  <li><a href="#exponential-and-logarithmic-curves" id="toc-exponential-and-logarithmic-curves" class="nav-link" data-scroll-target="#exponential-and-logarithmic-curves"><span class="header-section-number">2.3.2</span> Exponential and Logarithmic Curves</a></li>
  <li><a href="#power-laws" id="toc-power-laws" class="nav-link" data-scroll-target="#power-laws"><span class="header-section-number">2.3.3</span> Power Laws</a></li>
  <li><a href="#why-we-care-about-power-laws" id="toc-why-we-care-about-power-laws" class="nav-link" data-scroll-target="#why-we-care-about-power-laws"><span class="header-section-number">2.3.4</span> Why We Care About Power Laws</a></li>
  </ul></li>
  <li><a href="#convexity-and-concavity" id="toc-convexity-and-concavity" class="nav-link" data-scroll-target="#convexity-and-concavity"><span class="header-section-number">2.4</span> Convexity and Concavity</a>
  <ul class="collapse">
  <li><a href="#concavity-introduces-asymmetries" id="toc-concavity-introduces-asymmetries" class="nav-link" data-scroll-target="#concavity-introduces-asymmetries"><span class="header-section-number">2.4.1</span> Concavity Introduces Asymmetries</a></li>
  </ul></li>
  <li><a href="#equilibria" id="toc-equilibria" class="nav-link" data-scroll-target="#equilibria"><span class="header-section-number">2.5</span> Equilibria</a>
  <ul class="collapse">
  <li><a href="#equilibria-in-discrete-time" id="toc-equilibria-in-discrete-time" class="nav-link" data-scroll-target="#equilibria-in-discrete-time"><span class="header-section-number">2.5.1</span> Equilibria in Discrete-Time</a></li>
  </ul></li>
  <li><a href="#indifference-curves" id="toc-indifference-curves" class="nav-link" data-scroll-target="#indifference-curves"><span class="header-section-number">2.6</span> Indifference Curves</a></li>
  <li><a href="#contour-plots" id="toc-contour-plots" class="nav-link" data-scroll-target="#contour-plots"><span class="header-section-number">2.7</span> Contour Plots</a></li>
  <li><a href="#plotting-tricks" id="toc-plotting-tricks" class="nav-link" data-scroll-target="#plotting-tricks"><span class="header-section-number">2.8</span> Plotting Tricks</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-fun" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Interpreting Scientific Figures</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">2.1</span> Introduction</h2>
<p>Understanding scientific figures is an important part of becoming a scientist or a critical consumer of scientific information. This is a skill that, alas, is generally not taught in most schools. Here, I will try to provide a gentle introduction to reading scientific figures, especially theoretical plots. I have companion notes that describe how to generate scientific plots in <code>R</code>.</p>
<p>We use theory in science to bring order to the complexity we observe in the world. Theory generates our hypotheses but it also guides us in what we observe, how we measure it, and what we should find surprising. Surprise is essential for the scientific enterprise because it is the surprise that comes when we observe something novel from a process we thought we understood that generates innovation and explanation.</p>
<p>A couple starting points. We will use some very basic calculus here. Derivatives, second derivatives, and Taylor series.</p>
</section>
<section id="lines" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="lines"><span class="header-section-number">2.2</span> Lines</h2>
<p>Presumably, we all remember the formula for a straight line from high school algebra:</p>
<p><span class="math display">\[
y = mx + b,
\]</span></p>
<p>where <span class="math inline">\(m\)</span> is the slope and <span class="math inline">\(b\)</span> is the <span class="math inline">\(y\)</span>-intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(m<span class="sc">*</span>x<span class="sc">+</span>b, <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Clearly, this is a straight line. What this means is that for whatever <span class="math inline">\(x\)</span>-value you increment, you will increase by a factor of two.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define a linear function</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>lin <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">m=</span><span class="dv">2</span>,<span class="at">b=</span><span class="dv">1</span>) m<span class="sc">*</span>x <span class="sc">+</span> b</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># draw curve, add increments</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">lin</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">1</span>,<span class="fu">lin</span>(<span class="dv">1</span>),<span class="dv">3</span>,<span class="fu">lin</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">3</span>,<span class="fu">lin</span>(<span class="dv">1</span>),<span class="dv">3</span>,<span class="fu">lin</span>(<span class="dv">3</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">4</span>,<span class="fu">lin</span>(<span class="dv">4</span>),<span class="dv">6</span>,<span class="fu">lin</span>(<span class="dv">4</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">6</span>,<span class="fu">lin</span>(<span class="dv">4</span>),<span class="dv">6</span>,<span class="fu">lin</span>(<span class="dv">6</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">7</span>,<span class="fu">lin</span>(<span class="dv">7</span>),<span class="dv">9</span>,<span class="fu">lin</span>(<span class="dv">7</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">9</span>,<span class="fu">lin</span>(<span class="dv">7</span>),<span class="dv">9</span>,<span class="fu">lin</span>(<span class="dv">9</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Of course, we can show this analytically by calculating the derivative. Let <span class="math inline">\(f(x) = mx + b\)</span>, then <span class="math inline">\(f'(x) = m\)</span>. Not surprising since <span class="math inline">\(m\)</span> is literally the slope that the rate of change in <span class="math inline">\(f(x)\)</span> is always <span class="math inline">\(m\)</span>.</p>
<p>Linear change is a touchstone. We are often interested if something is changing faster or more slowly than linear.</p>
<p>We often use linear functions to approximate more complex functions in some restricted range. For example, in the model of optimal virulence, discussed below, we need to draw a tangent line to the function relating transmissibility to disease-induced mortality. This tangent line is a linear approximation of that function in the vicinity of the optimal virulence.</p>
<p>Note that this is what a derivative is. It’s linear representation of the slope of a function over an infinitesimal change of the input variable.</p>
</section>
<section id="curves" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="curves"><span class="header-section-number">2.3</span> Curves</h2>
<section id="polynomial-curves" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="polynomial-curves"><span class="header-section-number">2.3.1</span> Polynomial Curves</h3>
<p>When something is <em>nonlinear</em>, it changes at different rates in different parts of the curve. The simplest extension from a straight line is a polynomial, e.g., a quadratic function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quadratic function</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>quad <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">m=</span><span class="dv">2</span>,<span class="at">b=</span><span class="dv">1</span>) m<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>b</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">quad</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">1</span>,<span class="fu">quad</span>(<span class="dv">1</span>),<span class="dv">3</span>,<span class="fu">quad</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">3</span>,<span class="fu">quad</span>(<span class="dv">1</span>),<span class="dv">3</span>,<span class="fu">quad</span>(<span class="dv">3</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">4</span>,<span class="fu">quad</span>(<span class="dv">4</span>),<span class="dv">6</span>,<span class="fu">quad</span>(<span class="dv">4</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">6</span>,<span class="fu">quad</span>(<span class="dv">4</span>),<span class="dv">6</span>,<span class="fu">quad</span>(<span class="dv">6</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">7</span>,<span class="fu">quad</span>(<span class="dv">7</span>),<span class="dv">9</span>,<span class="fu">quad</span>(<span class="dv">7</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">9</span>,<span class="fu">quad</span>(<span class="dv">7</span>),<span class="dv">9</span>,<span class="fu">quad</span>(<span class="dv">9</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The quadratic curve changes at an increasing rate. For <span class="math inline">\(f(x) = mx^2 + b\)</span>, <span class="math inline">\(f'(x)=2x\)</span>.</p>
</section>
<section id="exponential-and-logarithmic-curves" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="exponential-and-logarithmic-curves"><span class="header-section-number">2.3.2</span> Exponential and Logarithmic Curves</h3>
<p>When people say that something is growing “exponentially,” what they usually mean is that it’s growing fast. Exponential growth is much more specific than that (and there are, indeed, ways to grow much faster than exponentially!). In continuous time, something grows exponentially if it increases at a constant rate regardless of its size.</p>
<p>Exponential growth has the wild property that the derivative of an exponential is proportional to the exponential itself. For example, if <span class="math inline">\(f(x)=e^r\)</span>, then <span class="math inline">\(f'(x) = e^r\)</span>. If <span class="math inline">\(f(x)=e^{2r}\)</span>, then <span class="math inline">\(f'(x) = 2e^{2r}\)</span>, and so on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">1</span>,<span class="fu">exp</span>(<span class="dv">1</span>),<span class="dv">3</span>,<span class="fu">exp</span>(<span class="dv">1</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">3</span>,<span class="fu">exp</span>(<span class="dv">1</span>),<span class="dv">3</span>,<span class="fu">exp</span>(<span class="dv">3</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">4</span>,<span class="fu">exp</span>(<span class="dv">4</span>),<span class="dv">6</span>,<span class="fu">exp</span>(<span class="dv">4</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">6</span>,<span class="fu">exp</span>(<span class="dv">4</span>),<span class="dv">6</span>,<span class="fu">exp</span>(<span class="dv">6</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">7</span>,<span class="fu">exp</span>(<span class="dv">7</span>),<span class="dv">9</span>,<span class="fu">exp</span>(<span class="dv">7</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">9</span>,<span class="fu">exp</span>(<span class="dv">7</span>),<span class="dv">9</span>,<span class="fu">exp</span>(<span class="dv">9</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looking at the increments, we quickly discern another important feature of exponential growth: it sneaks up on you! In the early phase of an exponential-growth process, it can be quite difficult to tell it apart from linear growth or even no growth. The red dotted lines showing the growth between <span class="math inline">\(x=1\)</span> and <span class="math inline">\(x=3\)</span> are barely visible.</p>
<p>Because of the explosiveness of exponential growth, the initial conditions can matter a lot for outcomes. Compare the following two curves:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">5</span><span class="sc">*</span><span class="fu">exp</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">*</span><span class="fu">exp</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We predict that virulence of a virus, for example, will increase with the size of the infectious innoculum. The intuition behind this prediction is that a larger innoculum provides a larger initial population size that can quickly increase to overwhelm a host’s immunological defenses. The smaller size of the viral population for any given time after infection arising from the smaller innoculum provides a greater likelihood that the host will control the infection quickly and with less tissue damage, etc.</p>
<p>It’s also super-important to note that things can also <em>decrease</em> exponentially! Exponential decay is a thing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">1</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>),<span class="dv">3</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">3</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>),<span class="dv">3</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">3</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">4</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">4</span>),<span class="dv">6</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">4</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">6</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">4</span>),<span class="dv">6</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">6</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">7</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">7</span>),<span class="dv">9</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">7</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">9</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">7</span>),<span class="dv">9</span>,<span class="dv">50</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">9</span>), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Compare them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw exp first to make sure axes fit</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(viridisLite)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">plasma</span>(<span class="dv">3</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">quad</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>c[<span class="dv">1</span>],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">lin</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(x), <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>c[<span class="dv">2</span>], <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">log</span>(x), <span class="fl">0.01</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span>c[<span class="dv">3</span>], <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"linear"</span>,<span class="st">"quadratic"</span>,<span class="st">"exponential"</span>,<span class="st">"logarithmic"</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,c), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="power-laws" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="power-laws"><span class="header-section-number">2.3.3</span> Power Laws</h3>
<p>It turns out that much of the world – particularly in biology – scales according to a power law. Nearly everything you can imagine measuring about an organism scales with an organism’s body mass and it does so according to a power law. So for some outcome <span class="math inline">\(Y\)</span> (e.g., lifespan, annual fertility, brain mass, metabolic rate, etc.), where we let <span class="math inline">\(W\)</span> indicate body mass, the scaling relationship takes the form</p>
<p><span class="math display">\[
Y = A W^a.
\]</span></p>
<p>If <span class="math inline">\(a&gt;1\)</span>, this curve will be convex (i.e., increasing returns to size), while if <span class="math inline">\(0&lt;a&lt;1\)</span>, the curve will be concave. If <span class="math inline">\(a=1\)</span>, then we simply have a straight line with slope <span class="math inline">\(A\)</span> and intercept zero. In comparative biology, the case where <span class="math inline">\(a=1\)</span> is known as “isometry” and the case where <span class="math inline">\(a \neq 1\)</span> is known as “allometry”.</p>
<p>If we take logarithms of both sides of the power-law relation, we get a linearized form,</p>
<p><span class="math display">\[
\log(Y) = \log(A) + a \log(W).
\]</span></p>
<p>Plotting data on double-logarithmic axes can help in diagnosing a power law.</p>
<p>When <span class="math inline">\(a&lt;0\)</span>, we have the case of power-law decay. This provides a very interesting case where the decay of some function can be considerably slower than exponential. For example, most of the common probability distributions that we use (e.g., normal, exponential, Poisson, binomial) have “exponential” tails. This means that the probability associated with a particular value decays exponentially as the values move away from the region of highest probability. In contrast, power-law probability distributions can have fat tails, meaning that extreme values are more likely than they would be under a comparable probability distribution with exponential decay.</p>
<p>The key difference between a power law and an exponential, which at first glance appear to be quite similar, is that for the power law, the power is constant (<span class="math inline">\(x^a\)</span>) whereas for an exponential, the power is the variable <span class="math inline">\(a^x\)</span> (where we usually use the specific value of <span class="math inline">\(a=e\)</span>, where <span class="math inline">\(e\)</span> is the base of the natural logarithm). Note that we’ve already looked at a comparison between exponential growth and power-law growth, when we compared the quadratic (<span class="math inline">\(a=2\)</span>) to the exponential. Let’s look at power-law decay now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fl">0.5</span><span class="sc">^</span>x,<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">xlab=</span><span class="st">"x"</span>, <span class="at">ylab=</span><span class="st">"y"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">^-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="fu">c</span>(<span class="st">"exponential"</span>,<span class="st">"power"</span>), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The power decay starts much higher (it is, in fact, asymptotic to the <span class="math inline">\(y\)</span>-axis) and declines very rapidly at first. However, while the exponential curve will quickly approach the <span class="math inline">\(x\)</span>-axis (to which it is asymptotic), the polynomial power-law curve will approach it very slowly. For the exponential curve, every <span class="math inline">\(x\)</span>-increment of one reduces the value of <span class="math inline">\(y\)</span> by a half. In contrast, for the power-law, every increment contributes a tiny marginal decay as the values of <span class="math inline">\(x\)</span> increase. For the exponential the ratio of subsequent <span class="math inline">\(y\)</span> values is <span class="math inline">\(0.5^{x+1}/0.5^{x} = 0.5^1=0.5\)</span> for all values of <span class="math inline">\(x\)</span>. The analogous ratio for the power law changes for different values of <span class="math inline">\(x\)</span>. When <span class="math inline">\(x\)</span> is small, the ratio of successive <span class="math inline">\(y\)</span> values is similar to the exponential. For example, when <span class="math inline">\(x=2\)</span>, <span class="math inline">\((x+1)^{-2}/x^{-2}=0.44\)</span>. However, when <span class="math inline">\(x=100\)</span>, the ratio is nearly one (=0.98), meaning that the curve is decreasing very slowly. Successive values of the function are nearly identical, making the ratio close to one.</p>
</section>
<section id="why-we-care-about-power-laws" class="level3" data-number="2.3.4">
<h3 data-number="2.3.4" class="anchored" data-anchor-id="why-we-care-about-power-laws"><span class="header-section-number">2.3.4</span> Why We Care About Power Laws</h3>
<p>The figure above shows how the probability of very high values decays to zero for the expontial function, but decays slowly for the polynomial power law. This turns out to be very important for thinking about the probability of extreme events.</p>
<p>We say that a probability distribution has a <em>heavy tail</em> if, for large values of <span class="math inline">\(x\)</span>, the log of the probability of <span class="math inline">\(x\)</span> is sublinear <span class="citation" data-cites="nair_etal2022">(<a href="references.html#ref-nair_etal2022" role="doc-biblioref">Nair, Wierman, and Zwart 2022</a>)</span>. Remember that when we take the logarithm of an exponential, we linearize it, so this is equivalent to saying that a heavy-tailed distribution decays more slowly than exponential. This is exactly what power-law distributions do. Their tails decay slowly – much slower than an exponential.</p>
<p>What this means is that if a random variable is characterized by a power-law distribution, extreme values, while not likely, are also not impossible. Heavy tails make the impossible only unlikely.</p>
<p>Consider the case of a normal (Gaussian) distribution, which has exponential tails and the related <span class="math inline">\(t\)</span>-distribution, which has heavy tails. The probability density function (pdf) for the normal distribution is:</p>
<p><span class="math display">\[
f(x)=\frac{1}{\sqrt{2 \pi \sigma^2}} e^{-\frac{(x-\mu)^2}{2 \sigma^2}},
\]</span> where the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> represent the mean and variance of the distribution.</p>
<p>The pdf for the <span class="math inline">\(t\)</span> distribution is:</p>
<p><span class="math display">\[
f(x) = \frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\pi \nu}\; \Gamma\left(\frac{\nu}{2}\right)}\left(1+\frac{x^2}{\nu}\right)^{-\frac{\nu+1}{2}},
\]</span> where the parameter <span class="math inline">\(\nu\)</span> represents the degrees of freedom of the distribution. Don’t worry too much about that first fraction in the pdf. That is just a normalizing factor that ensures that the probability integrates to one (as all pdfs must).</p>
<p>Note that, as with our last section, the pdf for the normal distribution (with exponential tail) has <span class="math inline">\(x\)</span> in the exponent, while for the <span class="math inline">\(t\)</span>-distribution (with polynomial tail), <span class="math inline">\(x\)</span> is being raised to a constant power related to the degrees of freedom.</p>
<p>We can compare the two probability density functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dnorm</span>(x), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.42</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Outcome (x)"</span>, <span class="at">ylab=</span><span class="st">"Probability of Outcome (P(x))"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dt</span>(x,<span class="at">df=</span><span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="fu">c</span>(<span class="st">"normal"</span>,<span class="st">"t"</span>), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The normal distribution is higher (i.e., has more mass) in the middle of the plot. The <span class="math inline">\(t\)</span> distribution has less of its mass in the central part of the distribution, and spreads out more of its total mass to its tails.</p>
<p>I should probably note that this is a particularly extreme <span class="math inline">\(t\)</span> distribution, as it only has one degree of freedom (this distribution is also known as a Cauchy distribution). This makes it particularly easy to see the differences between the normal and the <span class="math inline">\(t\)</span> distribution.</p>
<p>We can focus on just the right tail. Normal theory tells us that the probability of observing any values greater than four standard deviations aboce the mean is essentially zero. We can calculate the remaining area in the tail above four standard deviations (for the standard normal distribution) by subtracting the cumulative distribution function at <span class="math inline">\(x=4\)</span> from one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.167124e-05</code></pre>
</div>
</div>
<p>Pretty nearly zero.</p>
<p>What about the same calculation for our <span class="math inline">\(t\)</span> distribution with one degree of freedom?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="dv">4</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07797913</code></pre>
</div>
</div>
<p>Nearly eight percent of the total probability remains in the tail! That is, you have a 7.8% chance of observing a value of <span class="math inline">\(x \geq 4\)</span>.</p>
<p>Let’s compare a plot of the tails of the two distributions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dnorm</span>(x), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Outcome (x)"</span>, <span class="at">ylab=</span><span class="st">"Probability Density of Outcome (f(x))"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dt</span>(x,<span class="at">df=</span><span class="dv">1</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.01</span>,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,<span class="fu">c</span>(<span class="st">"normal"</span>,<span class="st">"t"</span>), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The horizontal dotted line indicates the value where the probability density is 1%. We can see that the <span class="math inline">\(t\)</span> distribution crosses this thresholds at a value of approximately <span class="math inline">\(x=6\)</span>. The term <em>six-sigma event</em> is often used to indicate an outcome that is essentially impossible under our current understanding of a system. This comes from the fact that for a standard normal distribution, the variable <span class="math inline">\(x\)</span> is equivalent to the number of standard deviations from the mean of zero (a standard normal has <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma^2=\sigma=1\)</span>). Thus, for a standard normal distribution, an observed value of of <span class="math inline">\(x=6\)</span> is six standard deviations (or <span class="math inline">\(6\sigma\)</span>) greater than the mean and, based on what we know about the normal distribution, has a probability of essentially zero. Not so for the <span class="math inline">\(t\)</span> distribution! We can see that even extremely high values of <span class="math inline">\(x\)</span> have associated tail probabilities that, while low, are still a long way from zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="dv">6</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05256846</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="dv">8</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03958342</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="dv">10</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03172552</code></pre>
</div>
</div>
<p>The key question, of course, is whether a <span class="math inline">\(t\)</span> distribution (or other heavy-tailed distribution) represents any phenomena we actually care about scientifically. Turns out, there are lots of things in Nature that follow power laws. One of the more interesting examples where the outcome is actually a <span class="math inline">\(t\)</span> distribution was described by <span class="citation" data-cites="weitzman2009">Weitzman (<a href="references.html#ref-weitzman2009" role="doc-biblioref">2009</a>)</span>. When you have to learn about the mean value of some normally-distributed variable, but have limited opportunities to learn, the distribution of that mean is itself a <span class="math inline">\(t\)</span> distribution. This has huge implications for decision-making that I will discuss elsewhere.</p>
</section>
</section>
<section id="convexity-and-concavity" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="convexity-and-concavity"><span class="header-section-number">2.4</span> Convexity and Concavity</h2>
<p>The derivative of a function provides a measure of how fast a function is changing. The second derivative measures how that rate of change itself is changing. In this sense, it measures the <em>curvature</em> of a function.</p>
<p>Many theoretical models depend on the curvature of functions to make their predictions. A common assumption employed in many theoretical models is that of concavity. A very common use of concavity in theory is when curve shows <em>diminishing marginal returns</em>. The word “marginal” essentially means the derivative, so diminishing marginal returns means that the derivative of the function is getting smaller for larger values of the input.</p>
<p>The classic trade-off model for the evolution of virulence relies on the concavity of transmissibility with respect to disease-induced mortality. If virulence produces decreasing marginal transmissibility with respect to disease-induced mortality, then selection will favor intermediate virulence. Denote virulence by <span class="math inline">\(x\)</span>. Both transmission and disease-induced mortality are functions of virulence: <span class="math inline">\(\beta(x)\)</span> and <span class="math inline">\(\delta(x)\)</span>. The fitness measure for the pathogen is, as usual, <span class="math inline">\(R_0\)</span>, which we can write as</p>
<p><span class="math display">\[
R_0 = \frac{\beta(x)}{\mu + \delta(x)},
\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the disease-independent mortality.</p>
<p>To find the optimal value of virulence, differentiate with respect to <span class="math inline">\(x\)</span> and solve for <span class="math inline">\(dR_0/dx=0\)</span>. Employing the quotient rule for differentiation and doing a little algebra to tidy up, we get:</p>
<p><span class="math display">\[
\frac{d \beta(x)}{d \delta(x)} = \frac{\beta(x^*)}{\mu + \delta(x^*)},
\]</span></p>
<p>where <span class="math inline">\(x^*\)</span> indicates the optimal value of virulence.</p>
<p>The geometric interpretation of this result is that optimal virulence satisfies the condition that a line, rooted at the origin, is tangent to the curve relating transmissibility to mortality. This result is known as the <em>Marginal Value Theorem</em> in behavioral ecology and, in addition to describing a model for optimal virulence, also predicts the optimal length of time for a foraging bout in a feeding patch or the optimal copula duration when a male has multiple mating opportunities but his sperm can be displaced by subsequent matings.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">30</span>,<span class="at">length=</span><span class="dv">500</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># transmissibility function fp&gt; 0 fpp &lt; 0</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.5</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span>(x<span class="dv">-7</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># derivative of the utility function</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>fprime <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.2</span><span class="sc">*</span>(x<span class="dv">-7</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st-degree Taylor series around x: f + fp*(z-x) = 0</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># z = x -(f/fp)</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># solve for tangency; find the root of this</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>xinter <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">-</span> <span class="fu">f</span>(x)<span class="sc">/</span><span class="fu">fprime</span>(x))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(xinter,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">40</span>))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">f</span>(x), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Mortality"</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Transmissibility"</span>,</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="at">labels=</span><span class="cn">FALSE</span>,<span class="at">tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>,<span class="at">labels=</span><span class="cn">FALSE</span>,<span class="at">tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,(<span class="fu">f</span>(soln<span class="sc">$</span>root)<span class="sc">/</span>soln<span class="sc">$</span>root)<span class="sc">*</span>x,<span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(soln<span class="sc">$</span>root,<span class="dv">0</span>,soln<span class="sc">$</span>root,<span class="fu">f</span>(soln<span class="sc">$</span>root), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>,<span class="fu">f</span>(soln<span class="sc">$</span>root),soln<span class="sc">$</span>root,<span class="fu">f</span>(soln<span class="sc">$</span>root), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(delta,<span class="st">"*"</span>)),<span class="dv">1</span>,<span class="at">at=</span>soln<span class="sc">$</span>root, <span class="at">padj=</span><span class="dv">1</span>)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(beta,<span class="st">"*"</span>)),<span class="dv">2</span>,<span class="at">at=</span><span class="fu">f</span>(soln<span class="sc">$</span>root),<span class="at">padj=</span><span class="fl">0.5</span>, <span class="at">adj=</span><span class="fl">1.5</span>, <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(mu),<span class="dv">1</span>,<span class="at">at=</span><span class="dv">5</span>, <span class="at">padj=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What would happen if the function was convex (<span class="math inline">\(f''(x)&gt;0\)</span>), rather than concave? There can be no intermediate optimum for a such a convex function. The optimal virulence is maximum.</p>
<p>In one of the most important papers in the field of life history theory, <span class="citation" data-cites="gadgil_bossert1970">Gadgil and Bossert (<a href="references.html#ref-gadgil_bossert1970" role="doc-biblioref">1970</a>)</span> noted that the only conditions under which natural selection will favor intermediate reproductive effort are when the fitness gains to effort are concave and, importantly, that the costs of effort are either linear or convex. We can easily visualize why this is the case.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">11</span>,,<span class="dv">110</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">log</span>(x)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">exp</span>(x<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">exp</span>(x<span class="sc">/</span><span class="fl">1.5</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># maxima</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> y<span class="sc">-</span>y1</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> y<span class="sc">-</span>y2</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>max1 <span class="ot">&lt;-</span> x[<span class="fu">which</span>(d1<span class="sc">==</span><span class="fu">max</span>(d1))]</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>max2 <span class="ot">&lt;-</span> x[<span class="fu">which</span>(d2<span class="sc">==</span><span class="fu">max</span>(d2))]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="do">### concave benefits/concave costs</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">10</span>,y<span class="sc">/</span><span class="dv">11</span>, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Reproductive Effort"</span>, </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Cost or Benefit"</span>,  </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">10</span>, y<span class="sc">/</span><span class="dv">11</span> <span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span>x, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#legend(0.05,1, c("Benefit","Cost"), lwd=3, lty=1, col=c("black","red"))</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.65</span>))</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"No Reproduction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">### concave benefits/convex costs</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">10</span>,y<span class="sc">/</span><span class="dv">11</span>, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Reproductive Effort"</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Cost or Benefit"</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">10</span>,y1<span class="sc">/</span><span class="dv">11</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>max1<span class="sc">/</span><span class="dv">11</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.65</span>))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#legend(0.05,1, c("Benefit","Cost"), lwd=3, lty=1, col=c("black","red"))</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Intermediate Reproduction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="do">### concave benefits/concave costs, full RE</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">10</span>,y<span class="sc">/</span><span class="dv">11</span>, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Reproductive Effort"</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Cost or Benefit"</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">10</span>, y<span class="sc">/</span><span class="dv">11</span> <span class="sc">+</span> <span class="fl">0.01</span><span class="sc">*</span>x, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#legend(0.05,1, c("Benefit","Cost"), lwd=3, lty=1, col=c("black","red"))</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.65</span>))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Maximal (Suicidal) Reproduction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Only for the concave benefit/linear cost case does the maximum difference between the curves lie in the middle of the plot.</p>
<section id="concavity-introduces-asymmetries" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="concavity-introduces-asymmetries"><span class="header-section-number">2.4.1</span> Concavity Introduces Asymmetries</h3>
<p>Suppose you have a curve representing the fitness, <span class="math inline">\(w\)</span>, corresponding to a given level of effort, <span class="math inline">\(x\)</span>, similar to the Gadgil-Bossert curves discussed above. Further suppose that this curve is concave, showing diminishing marginal returns so that <span class="math inline">\(w'(x)&gt;0\)</span> and <span class="math inline">\(w''&lt;0\)</span>.</p>
<p>Starting at some point on this curve, say at the mean effort <span class="math inline">\(\bar{x}\)</span>, imagine you flip a coin and get decremented a unit’s worth of fitness if it comes up heads and increase a unit’s worth if it comes up tails. This is known as a lottery, a decision in which there is a discrete, variable payoff. We can plot this as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## risk-aversion</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>fx <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>x)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="do">## for part deux</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>aaa <span class="ot">&lt;-</span> (fx<span class="fl">-0.4882412</span>)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(aaa<span class="sc">==</span><span class="fu">min</span>(aaa))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 179</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[1] 179</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,fx, <span class="at">type=</span><span class="st">"n"</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Parity (x)"</span>, <span class="at">ylab=</span><span class="st">"Fitness (w(x))"</span>, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>,<span class="fl">5.1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#segments(0,0,5,fx[1000], lwd=2, col=grey(0.75))</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="dv">5</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(x[<span class="dv">0</span>]), <span class="fu">expression</span>(<span class="fu">bar</span>(x)),</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">expression</span>(x[<span class="dv">1</span>])), <span class="at">tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.5</span>,<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="fl">0.846645</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.65</span>))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.5</span>,<span class="fl">0.846645</span>,<span class="dv">0</span>,<span class="fl">0.846645</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">0</span>,<span class="fl">0.846645</span>,<span class="dv">0</span>,<span class="fl">0.01</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">length=</span>.<span class="dv">25</span>,<span class="at">angle=</span><span class="dv">10</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.5</span>,<span class="fl">0.846645</span>,<span class="dv">5</span>,<span class="fl">0.846645</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">5</span>,<span class="fl">0.846645</span>,<span class="dv">5</span>,fx[<span class="dv">1000</span>], <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">length=</span>.<span class="dv">25</span>,<span class="at">angle=</span><span class="dv">10</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,fx, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The upside of this lottery increases fitness considerably less than the downside reduces it. This arises because of the curvature of the function, in particular, its diminishing marginal fitness returns to effort. This is a very important insight and defines the phenomenon of <em>risk aversion</em>. Risk-aversion in lotteries where the fitness function is a concave function of effort are an application of Jensen’s Inequality, which states that for a concave function, <span class="math inline">\(w(x)\)</span>,</p>
<p><span class="math display">\[
w(E(x)) \geq E(w(x)),
\]</span></p>
<p>where <span class="math inline">\(E()\)</span> indicates mathematical expectation.</p>
<p>We can show this graphically. We will draw a chord connecting the upside- and downside-payoffs, the midpoint of which is <span class="math inline">\(E(w(x))\)</span>. Note that this is considerably less than <span class="math inline">\(w(\bar{x})\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,fx, <span class="at">type=</span><span class="st">"n"</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Parity (x)"</span>, <span class="at">ylab=</span><span class="st">""</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">5.1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,fx[<span class="dv">1000</span>], <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="fl">0.05</span>,x[<span class="dv">179</span>],<span class="fl">2.5</span>,<span class="dv">5</span>), </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(x[<span class="dv">0</span>]), <span class="fu">expression</span>(x[C]),</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">expression</span>(<span class="fu">bar</span>(x)), <span class="fu">expression</span>(x[<span class="dv">1</span>])),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Fitness (w(x))"</span>, <span class="at">side=</span><span class="dv">2</span>,<span class="at">line=</span><span class="dv">2</span>, <span class="at">adj=</span><span class="fl">0.65</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fl">0.4882412</span>, <span class="at">labels=</span><span class="st">""</span>, <span class="at">tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.5</span>,<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="fl">0.4882412</span>,<span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) <span class="co"># vertical line at bar(x)</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.5</span>,<span class="fl">0.4882412</span>,<span class="fl">2.5</span>,fx[<span class="dv">501</span>], <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,fx, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A risk-averse decision-maker should be willing to pay for certainty. We can show why this is graphically. Note that the expected fitness of this lottery (i.e., the average of the two possible outcomes) does not, in fact, fall on the fitness curve. We can move horizontally from this point back to the curve and the fitness would not change. If (and this is a big if) we can achieve certainty in our payoff by paying the difference between <span class="math inline">\(E(w(x))\)</span> and what is called the <em>certainty-equivalent</em> return, we should.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,fx, <span class="at">type=</span><span class="st">"n"</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Parity (x)"</span>, <span class="at">ylab=</span><span class="st">""</span>, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">5.1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,fx[<span class="dv">1000</span>], <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="fl">0.05</span>,x[<span class="dv">179</span>],<span class="fl">2.5</span>,<span class="dv">5</span>), </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(x[<span class="dv">0</span>]), <span class="fu">expression</span>(x[C]),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">expression</span>(<span class="fu">bar</span>(x)), <span class="fu">expression</span>(x[<span class="dv">1</span>])),</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Fitness (w(x))"</span>, <span class="at">side=</span><span class="dv">2</span>,<span class="at">line=</span><span class="dv">2</span>, <span class="at">adj=</span><span class="fl">0.65</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fl">0.4882412</span>, <span class="at">labels=</span><span class="st">""</span>, <span class="at">tick=</span><span class="cn">FALSE</span>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.5</span>,<span class="dv">0</span>,<span class="fl">2.5</span>,<span class="fl">0.4882412</span>,<span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) <span class="co"># vertical line at bar(x)</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.5</span>,<span class="fl">0.4882412</span>,x[<span class="dv">179</span>],<span class="fl">0.4882412</span>,<span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) <span class="co"># horizontal line back to utility curve</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(x[<span class="dv">179</span>],<span class="fl">0.4882412</span>,x[<span class="dv">179</span>],<span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"green"</span>) <span class="co"># vertical line to x_c</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,fx, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.35</span>, <span class="fl">0.54</span>, <span class="fu">expression</span>(pi<span class="sc">==</span><span class="fu">bar</span>(x) <span class="sc">-</span> x[C]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="equilibria" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="equilibria"><span class="header-section-number">2.5</span> Equilibria</h2>
<p>In ecology, evolution, etc., we frequently plot two (or more) sets of rates. For example: birth and death rates in a demographic model or rates of colonization and extinction in a metapopulation model.</p>
<p>For example, the classic Levins model for metapopulations</p>
<p><span class="math display">\[
\dot{n} = cn(1-n) - en,
\]</span></p>
<p>where <span class="math inline">\(n\)</span> is patch occupancy, <span class="math inline">\(c\)</span> is the colonization rate, and <span class="math inline">\(e\)</span> is the extinction rate. The equilibrium for this happens when <span class="math inline">\(\dot{n}=0\)</span>, which is</p>
<p><span class="math display">\[
\hat{n} = 1 - \frac{e}{c}.
\]</span></p>
<p>If the extinction rate is greater than the colonization rate (<span class="math inline">\(e&gt;c\)</span> ), then, sensibly, the overall population is extinct. Moreover, there will generally always be unoccupied patches at equilibrium.</p>
<p>A classic example of a graphical representation of such an equilibrium process is the MacArthur-Wilson model, which is similar to the Levins metapopulation model in that it posits the number of species on an island is a dynamic balance between the colonization rate (which declines as a function of the number of resident species) and the extinction rate (which increases as a function of the number of resident species). The equilibrium occurs where the colonization rate just balances out the extinction rate, so that the overall rate of change of species is zero, the definition of an equilibrium.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,,<span class="dv">500</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>cinit <span class="ot">&lt;-</span> <span class="dv">55</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, cinit<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>rate<span class="sc">*</span>n), <span class="at">type=</span><span class="st">"l"</span>, </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"#0D0887FF"</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Number of Species"</span>, </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Rate"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">60</span>),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">23</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">yaxs=</span><span class="st">"i"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(n, <span class="fu">exp</span>(rate<span class="sc">*</span>n), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"#9C179EFF"</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">log</span>(cinit)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>rate),<span class="dv">0</span>,<span class="fu">log</span>(cinit)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>rate),<span class="fu">exp</span>(rate<span class="sc">*</span><span class="fu">log</span>(cinit)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>rate)), <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="fu">log</span>(cinit)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>rate)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(N))))</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="equilibria-in-discrete-time" class="level3" data-number="2.5.1">
<h3 data-number="2.5.1" class="anchored" data-anchor-id="equilibria-in-discrete-time"><span class="header-section-number">2.5.1</span> Equilibria in Discrete-Time</h3>
<p>Recursions.</p>
<p>Poverty-trap model. We plot the wealth at time <span class="math inline">\(t+1\)</span> agains the wealth at time <span class="math inline">\(t\)</span>. Use a Prelec weighting function to produce the characteristic S-shape of the poverty-trap model. An equilibrium occurs when the the wealth in the next time step is equal to the wealth in the current time step (i.e., there is no change). In this plot, this occurs wherever our curve touches the line of equality, <span class="math inline">\(w_{t+1}=w_t\)</span>.</p>
<p>The downside of the Prelec function is that we can’t easily solve for an equilibrium analytically, but we can solve it numerically using <code>uniroot()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>prelec <span class="ot">&lt;-</span> <span class="cf">function</span>(p,a,b) (<span class="fu">exp</span>(<span class="sc">-</span>(<span class="sc">-</span><span class="fu">log</span>(p))<span class="sc">^</span>a))<span class="sc">^</span>b</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="do">## function to solve for interior equilibrium</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="cf">function</span>(p,a,b) (<span class="fu">exp</span>(<span class="sc">-</span>(<span class="sc">-</span><span class="fu">log</span>(p))<span class="sc">^</span>a))<span class="sc">^</span>b <span class="sc">-</span> p</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1.7</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we know p=0 and p=1 are solutions so limit to searching an interior interval</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>pint <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(fn,<span class="at">interval=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>),<span class="at">a=</span>a,<span class="at">b=</span>b)<span class="sc">$</span>root</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,,<span class="dv">1000</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p, <span class="fu">prelec</span>(<span class="at">p=</span>p,<span class="at">a=</span>a,<span class="at">b=</span>b), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"blue4"</span>, <span class="at">lwd=</span><span class="dv">2</span>, </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(W[t]), <span class="at">ylab=</span><span class="fu">expression</span>(W[t<span class="sc">+</span><span class="dv">1</span>]),</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">1.05</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.05</span>,<span class="fl">1.05</span>))</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="dv">0</span>,pint,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">prelec</span>(<span class="at">p=</span>pint,<span class="at">a=</span>a,<span class="at">b=</span>b),<span class="dv">1</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">1</span>,<span class="dv">19</span>), <span class="at">cex=</span><span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are three equilibria for the poverty-trap model: (1) a stable equilibrium at destitution (<span class="math inline">\(w_t=0\)</span>), (2) an unstable interior equilibrium, and (3) a stable equilibrium at maximum wealth.</p>
</section>
</section>
<section id="indifference-curves" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="indifference-curves"><span class="header-section-number">2.6</span> Indifference Curves</h2>
<p>We encounter indifference curves when we consider the case of multi-species epidemics, as described by Holt and colleagues (2003). Suppose there is an infectious disease that can infect multiple species. In order to be above the epidemic threshold, there have to be a certain minimum number of susceptible individuals.</p>
<p>On one side of the curve – where the minimum conditions for an epidemic are exceeded – an epidemic is possible. On the other side of the curve, no epidemic is possible. Any combination of species numbers along the isoclines satisfy the conditions equally well. This is why we call them “indifference curves.”</p>
<p>Start with the trivial case where the two species don’t interact at all. There will be an epidemic if there are either enough of species 1 or of species 2. The region where both species are below their respective thresholds lies inside the rectangular isocline</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"n"</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>, <span class="at">xlab=</span><span class="st">"Specis 1"</span>, <span class="at">ylab=</span><span class="st">"Species 2"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">6</span>,<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">6</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">6</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(S)[<span class="dv">1</span>])))</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">6</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(S)[<span class="dv">2</span>])))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">3</span>,<span class="dv">3</span>, <span class="st">"No Epidemic"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">7.5</span>,<span class="fl">7.5</span>, <span class="st">"Epidemic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now consider the slightly more interesting case where hosts of different species can substitute for each other. This means that even if the critical threshold for either of the species is reached, there can still be an epidemic. If the pathogen is not well adapted to a generalist-transmission mode, this effect might be quite small. We can call the epidemic isocline that arises from such conditions <em>weakly-interacting.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>),,<span class="dv">500</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">5</span><span class="sc">*</span>g<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g,h, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Species 1"</span>, <span class="at">ylab=</span><span class="st">"Species 2"</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>)), <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(S)[<span class="dv">1</span>])))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">1</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(S)[<span class="dv">2</span>])))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>),<span class="dv">1</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>),<span class="dv">0</span>,<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>),<span class="dv">1</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.2</span>,<span class="fl">0.45</span>, <span class="st">"No Epidemic"</span>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.4</span>,<span class="fl">0.9</span>, <span class="st">"Epidemic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I’ve left the non-interacting isocline in this figure to show how, even though species are only interacting weakly, the space in which an epidemic is possible is greater.</p>
<p>Now consider the case where <em>substitutable</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">type=</span><span class="st">"n"</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>, </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">xaxs=</span><span class="st">"i"</span>,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Species 1"</span>, <span class="at">ylab=</span><span class="st">"Species 2"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="dv">9</span>,<span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">9</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(S)[<span class="dv">1</span>])))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="dv">9</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(S)[<span class="dv">2</span>])))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.8</span>,<span class="fl">2.7</span>, <span class="st">"No Epidemic"</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">6.7</span>,<span class="fl">5.3</span>, <span class="st">"Epidemic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A perfectly substitutable curve is linear. This means if you can substitute one individual of species 2 for one individual of species 1 when species 1 is just below its critical threshold and still get an epidemic, you can substitute one for one at any point along the isocline. Now, the slope might not be unity. Maybe you have to substitute two of species 2 for one of species 1. The key is that ratio of substitution remains the same for any mixture of the two species.</p>
<p>Things get more interesting when having a mixture of the two species makes it more likely that there will be an epidemic when there is a more event mixture of the two species that when the mixture is toward one of the extremes (i.e., mostly species 1 or mostly species 2). We call such an isocline <em>complementary</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,,<span class="dv">1000</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x), </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"n"</span>, </span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>, </span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, </span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Species 1"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Species 2"</span>, </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">9</span>), </span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.02</span>,<span class="fl">0.4</span>))</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x), <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">2</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="dv">2</span>),<span class="fu">log</span>(<span class="fl">0.02</span>)<span class="sc">/-</span><span class="fl">0.5</span>,<span class="fl">0.02</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="fl">7.859947</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(S)[<span class="dv">1</span>])))</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at=</span><span class="fu">c</span>(<span class="fl">0.36800318</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">hat</span>(S)[<span class="dv">2</span>])))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">3</span>, <span class="fl">0.08755055</span>, <span class="st">"No Epidemic"</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">5</span>,<span class="fl">0.13</span>, <span class="st">"Epidemic"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To see this, we can look at how the rate of substitution happens at different mixtures of the two species. For example, as you approach the extreme of <span class="math inline">\(S_1=0\)</span>, it takes increasingly more of <span class="math inline">\(S_2\)</span> to stay above the epidemic threshold. This is obviously also true as we approach the <span class="math inline">\(S_2=0\)</span> extreme as well, but we’ll focus on the <span class="math inline">\(S_1=0\)</span> extreme here. In the middle of the range, a small change in one can be compensated by a small change in the other, making the epidemic threshold easier to achieve in the middle of the species’ population sizes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,,<span class="dv">1000</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x), </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"n"</span>, </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>, </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Species 1"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Species 2"</span>, </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">12</span>), </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.002</span>,<span class="fl">0.4</span>))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>x), <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.1</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">2.1</span>),<span class="fl">2.1</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">2.6</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.1</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">2.6</span>),<span class="fl">2.6</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">2.6</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">5</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="dv">5</span>),<span class="dv">5</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">5.5</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">5</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">5.5</span>),<span class="fl">5.5</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fl">5.5</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="interpreting_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="contour-plots" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="contour-plots"><span class="header-section-number">2.7</span> Contour Plots</h2>
</section>
<section id="plotting-tricks" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="plotting-tricks"><span class="header-section-number">2.8</span> Plotting Tricks</h2>
<p>I have a whole other set of notes on how to produce scientific figures in <code>R</code>. However, I’ve repeatedly done some things in these notes that merit a brief explanation. Otherwise, there is a risk of things seeming obscure and generally confusing.</p>
<p>Theoretical plots usually don’t depend on specific values of inputs or functions – you typically care just about the shapes and not the specific values. You are trying to show the general behavior of your system. <code>R</code> is a statistical programming language and, as such, expects you to be plotting data. Presumably, you care about the actual values when data are involved. For our theoretical plots, we usually want to suppress the values on the plot’s axes. This is why nearly all of these figures include the arguments to the <code>plot()</code> command <code>axes=FALSE</code> and <code>frame=TRUE</code>. This suppresses the axes and any ticks and labels indicating specific values on them. We can then add in custom axis labels, such as the critical population size for each species in the multi-species epidemic isoclines using the command <code>axis()</code>.</p>
<p>Perhaps a more mysterious trick I use is to include the arguments <code>xaxs="i"</code> and <code>yaxs="i"</code>. This is really the special sauce of a scientific-theory plot in <code>R</code>. Again, <code>R</code> expects data when you call the <code>plot()</code> command. A good aesthetic practice for data plots is to pad the range of the observed data and <code>R</code> does this by default. By forcing the style of the axes to be “internal” (that’s what the “i” stands for), you restrict the axes to the range of your data. This means that <span class="math inline">\(y\)</span>-intercepts actually intercept the <span class="math inline">\(y\)</span> axis, curves that should start at zero actually look like they’re starting at zero, etc.</p>
<p>We often want to lay out the axes but not draw a curve quite yet. To do this, we add the argument <code>type="n"</code> to the <code>plot()</code> command. This allows us to build up complex figures with more precision and control. You might notice that we often plot the actual curve we care about last. This is because we want it on top of the various lines we’ve added to indicate interesting bits of the curve (e.g., equilibria and such).</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-gadgil_bossert1970" class="csl-entry" role="listitem">
Gadgil, Madhav, and William H. Bossert. 1970. <span>“Life Historical Consequences of Natural Selection.”</span> <em>The American Naturalist</em> 104 (935): 1–24. <a href="http://www.jstor.org/stable/2459070">http://www.jstor.org/stable/2459070</a>.
</div>
<div id="ref-nair_etal2022" class="csl-entry" role="listitem">
Nair, Jayakrishnan, Adam Wierman, and Bert Zwart. 2022. <em>The Fundamentals of Heavy Tails: Properties, Emergence, and Estimation</em>. Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge: Cambridge University Press.
</div>
<div id="ref-weitzman2009" class="csl-entry" role="listitem">
Weitzman, M. L. 2009. <span>“On Modeling and Interpreting the Economics of Catastrophic Climate Change.”</span> <em>The Review of Economics and Statistics</em> XCI (1): 1–19. <a href="https://doi.org/10.1162/rest.91.1.1 ">https://doi.org/10.1162/rest.91.1.1 </a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./gettingR.html" class="pagination-link" aria-label="Getting Started in R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started in R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./drawing.html" class="pagination-link" aria-label="Theoretical Scientific Figures in `R`">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Theoretical Scientific Figures in <code>R</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>